#import "../module/module.typ": *
#show: module

#let H = o-color("H", rgb("#d25b00"))
#let a = o-color("a", rgb("#d25b00"))
#let x = o-color("x", rgb("#006dea"))
#let p = o-color("p", rgb("#d25b00"))

For Schrodinger eq, harmonic oscillator potential
$
  #i ‚àÇ_t œà = (- (‚Ñè^2)/(2 m) ‚àÇ_x^2 + 1/2 m œâ^2 x^2) œà = ((#p^2)/(2m) + 1/2 m #x^2) œà
$
Calculate all #link(<quamtum-operator-motivation>)[Œ¥ action Lie bracket]
$
  [#H, œâ (#i/‚Ñè m #x)] &= ‚Ñè œâ ‚ãÖ (-#i) #i/‚Ñè #p \
  [#H, #i/h #p] &= ‚Ñè œâ ‚ãÖ #i œâ (#i/‚Ñè m #x)
$
This commutation relation is partially similar to $so(3)$ complexification eigenvalue technique (@ref-13, p.20--30) (will be used in the treatment of angular momentum operator)

Complexify to get the characteristic operator of $[#H,*]$, obtaining #tag("ladder-operator")
$
  #a _ ¬± &= (m œâ)/‚Ñè #x ‚àì #i/‚Ñè #p = ((m œâ) / ‚Ñè #x ‚àì (#d)/(#d x)) \
  (#a _ ¬±) ^‚Ä† &= #a _ ‚àì \
  [#H, #a _ ¬±] &= ¬± ‚Ñè œâ #a _ ¬±
$
This commutation relation indicates that $#H$ has eigenvalues with uniform spacing $‚Ñè œâ$
$
  #H œà = E œà 
  ==> #H #a _ ¬± œà &= #a _ ¬± #H œà ¬± ‚Ñè œâ #a _ ¬± œà \
  &= (E ¬± ‚Ñè œâ) #a _ ¬± œà
$
*Question* Try to generalize the technique here to (if possible) $‚ÑÇ$ classical harmonic oscillator

The lowest energy state $œà$ of the $‚Ñï$ $L^2$ eigenstates given by the ladder operator of $‚Ñù$ harmonic oscillator quantization satisfies #tag("harmonic-oscillator-ground-state")
$
  #a _ - œà = 0 &==> (#d œà)/(#d x) = - (m œâ)/‚Ñè x œà \
  &==> œà = ((m œâ)/‚Ñè 1/œÄ)^(1/4) exp(- 1/2 (m œâ)/‚Ñè x^2) 
$
Calculate the action of the $#H$ operator, obtaining the lowest energy of $1/2 ‚Ñè œâ$

high order energy states (normalized)
$
  œà_n = 1/(n!)^(1/2) (2 (m œâ)/‚Ñè)^(-n/2) #a _ + ^n œà
$ 
Energy is $E_n = (1/2 + n) ‚Ñè œâ$

Using $- e^(1/2 y^2) (#d^n)/(#d y^n) e^(- 1/2 y^2) œï(y) = (y - (#d)/(#d y)) œï(y) ‚àº #a _ +$ the eigenstate can be written as
$
  œà_n 
  &= 1/(n!)^(1/2) 1/2^(n/2) H_n ((frac(m œâ , ‚Ñè œÄ) x)^(1/2)) 
  ‚ãÖ (frac(m œâ , ‚Ñè œÄ))^(1/4) exp(-1/2 frac(m œâ, ‚Ñè) x^2) \
  H_n (y) &= (-1)^n e^(y^2) (#d^n)/(#d y^(n)) e^(- y^2)
$
$H_n$ is called Hermite polynomial 

For quantum harmonic oscillator, even for static wave function, there are $‚Ñï$ possible characteristic energies $E_n = (1/2 + n) ‚Ñè œâ$

_Warning_ Don't assume that since the lowest energy is non-zero $1/2 ‚Ñè œâ$, there is energy out of nowhere, because the energy of a static hydrogen atom can still be negative

It can be proven that this $‚Ñï$ eigenstate series orthogonally expands $L^2$
#indent[
  For example, prove that $y^n e^(- 1/2 y^2), n = 0 .. ‚àû$ expands $L^2$ using Fourier transform method
  
  Assume that the orthogonal $integral_ ‚Ñù y^n e^(- 1/2 y^2) f(y) #d y = 0$, define $g(y) = e^(- 1/2 y^2) f(y)$ 
  
  Fourier transform $hat(g)(Œæ) = integral_ ‚Ñù e^(- #i Œæ y) g(y) #d y$ 
  
  All order derivatives at $Œæ = 0$ are equal to zero $(#d^n )/(#d Œæ^n) hat(g)(0) = integral_ ‚Ñù y^n e^(- 1/2 y^2) f(y) #d y = 0$
]
The quadratic form interpretation of the $L^2$ expansion coefficients $sum c_n œà_n, sum |c_n|^2 = 1$ is the probability in $œà_n$. The expected energy is $‚ü® #H ‚ü© = sum |c_n|^2 E_n$

In addition to causing the eigenvalues of $#H$ to be uniformly spaced, the ladder operators also satisfy $1/2 [#a _ + , #a _ -] = (m œâ)/‚Ñè ùüô$, which allows them to correspond to 
- metric symmetric tensor space $#a _ + (œï) = œï ‚äô, #a _ - (œï) = (œï ‚äô)^‚Ä†, [#a _ + (œï), #a _ - (œï)] = ‚ü® œï , œï ‚ü© ùüô$ 
- symmetric polynomial space $#a _ + = z, #a _ - = (#d)/(#d z)$
They also satisfy $1/2 {#a _ + , #a _ -} = (‚Ñè/(2 m))^(-1) #H$

Since it is not $[#a _ + , #a _ -] ‚àº #H$, the situation for different states to $so(3)$ complexified eigenvalue technique

#tag("Gaussian-integral")
#indent[
  $ integral_(-‚àû)^(‚àû) e^(- a x^2) #d x = (œÄ/a)^(1/2) $

  Holds for $a > 0$. $a > 0$ contains dense points, consistent with the uniqueness of analytic continuation. Analytically continued to $a in ‚ÑÇ ‚àñ 0$. But note that $(œÄ/a)^(1/2)$ has a double branch.

  Diagonalize the quadratic form $A$ into $"diag"(a_1 ,‚Ä¶, a_n)$ on Euclidean type $‚Ñù^n$ using an orthonormal basis.
  $
    integral_(‚Ñù^n) e^(- ‚ü® x mid(|) A mid(|) x ‚ü©) #d x 
    &= integral_(‚Ñù^n) e^(-(a_1 x_1^2 + ‚ãØ + a_n x_n^2)) #d x \
    &= integral_(-‚àû)^(‚àû) e^(- a_1 x_1^2) #d x_1 ‚ãØ integral_(-‚àû)^(‚àû) e^(- a_n x_n^2) #d x_n \
    &= (œÄ/a_1)^(1/2) ‚ãØ (œÄ/a_n)^(1/2) \
    &= (œÄ^(n/2))/(a_1 ‚ãØ a_n)^(1/2) \
    &= (œÄ^(n/2))/(det A)^(1/2)
  $
]
#tag("why-pi-in-Gaussian-integral") 
#indent[
  This might provide a clue as to why $œÄ$ appears in the #link(<Stirling-approximation>)[Stirling approximation] of the factorial $n! ‚âà (2 œÄ)^(1/2) n^(1/2) (n/e)^(n)$.

  The characteristic polynomial of the harmonic oscillator ODE $acc(x) = - œâ^2 x$ is $Œæ^2 = - œâ^2$, the prototype is $Œæ^2 = -1$, so $#i$ and complex numbers are introduced, which leads to circles, and thus $œÄ$. $e^(- 1/2 x^2)$ is related to the ground state of the quantum harmonic oscillator. For simplicity, $‚Ñè$ is omitted. The general momentum operator $- #i ‚àÇ_x$ actually corresponds to a phase change $e^(#i) != 1$. If we add a $œÄ$ scaling factor to the momentum operator, then the momentum operator can correspond to a phase change $e^(#i 2 œÄ) = 1$. At this time, the ground state may also become $e^(- a x^2)$ where $a$ contains a $œÄ$ factor, and its $L^2$ integral is directly normalized, without needing to add a $œÄ$ scaling factor. Similarly, for #link(<path-integral-quantization>)[Feynman path integrals], using this method may no longer require additional normalization factors or Zeta function regularization.

  The appearance of $œÄ$ in Stirling's approximation might also be similar. One should ask where the factorial (or its reciprocal) with the scaling factor $œÄ$ comes from, for example, from the volume calculation of spheres and spherical surfaces.

  Another revelation is that the $frac(œâ T, sin œâ T)$ appearing in the kernel of the Feynman #link(<path-integral-quantization>)[path integral quantization] of the harmonic oscillator corresponds to the property of the #link(<factorial-function-1>)[factorial function] $z!(-z)! = (œÄ z)/(sin œÄ z)$, where an additional $œÄ$ scaling factor also appears. Therefore, should the modified factorial function satisfy $z!(-z)! = (z)/(sin z)$?
]
If the solution of the harmonic oscillator $a(#i) e^(-#i œâ t) + a(-#i) e^(#i œâ t)$ uses fixed starting positions $x_0,x_1$, then 
$ 
  a(#i) = frac(
    x_1 e^(œâ t_0 #i) - x_0 e^(œâ t_1 #i),
    e^(œâ (t_1 - t_0) (- #i)) - e^(œâ (t_1 - t_0) #i)
  ) 
$
where $e^(œâ (t_1 - t_0) #i) - e^(œâ (t_1 - t_0) (- #i)) = 2 #i sin œâ (t_1 - t_0)$

Action
$
  S_"cl" (t_0, t_1, x_0,x_1) 
  &= integral_(t_0)^(t_1) #d t space
    1/2 m œâ^2 ‚ãÖ 4 Re ‚ü® a(- #i) e^(œâ t #i), a(#i) e^(œâ t (- #i)) ‚ü© \
  &= 1/2 m œâ^2 ‚ãÖ 4 ‚ãÖ 1/œâ
    (Im ‚ü® a(- #i) e^(œâ t #i), a(#i) e^(œâ t (- #i)) ‚ü©) |_(t_0)^(t_1) \
  &= 1/2 m œâ ‚ãÖ 
    frac(
      (|x_1|^2 + |x_0|^2) cos œâ (t - t_0) - 2 Re ‚ü® x_1, x_0 ‚ü©, 
      sin œâ (t - t_0)
    ) 
$
where $2 cos œâ (t - t_0) = e^(œâ (t_1 - t_0) #i) + e^(œâ (t_1 - t_0) (- #i))$

For time only depending on the difference $t_1 - t_0$

#tag("path-integral-quantization") 
#indent[
  cf. (@ref-28, ch.path-integral-formalism)

  Propagator $K$ represents constructing unitary using Feynman path integrals and Lagrangian.
  
  For free field
  $
    K(t_0,x_0,t_1,x_1) = integral_(x(t_0) = x_0)^(x(t_1) = x_1) #d x(t) exp(#i/‚Ñè integral_(t_0)^(t_1) #d t (1/2 m vel(x)^2))
  $
  Decomposed into classical path and gap $x = x_"cl" + y$, $y(t_0) = y(t_1) = 0$ 
  $
    integral_(t_0)^(t_1) #d t (1/2 m (vel(x)_"cl" + vel(y))^2) 
    = integral_(t_0)^(t_1) #d t (1/2 m (vel(x)_"cl"^2 + vel(y)^2 + 2 vel(x)_"cl" vel(y)))
  $
  - $vel(x)_"cl" vel(y) = (#d)/(#d t) (vel(x)_"cl" y) - acc(x)_"cl" y$ 
  - Boundary is zero $y(t_0) = y(t_1) = 0$ 
  - $acc(x)_"cl" = 0$ 
  ==> $integral_(t_0)^(t_1) #d t (vel(x)_"cl" vel(y)) = 0$

  Now
  $
    K(t_0,x_0,t_1,x_1) = exp(#i/‚Ñè S[x_"cl" (t)]) integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(#i/‚Ñè S[y(t)])
  $
  Where, due to the classical path of a free particle being a straight line $x_"cl" (t) = x_0 + (x_1 - x_0)/(t_1 - t_0) (t - t_0)$
  $
    S[x_"cl" (t)] 
    &= integral_(t_0)^(t_1) #d t (1/2 m vel(x)_"cl"^2) \
    &= 1/2 m frac((x_1 - x_0)^2,t_1 - t_0)
  $

  - $vel(y)^2 = (#d)/(#d t) (y vel(y)) - y acc(y)$ 
  - Boundary is zero $y(t_0) = y(t_1) = 0$ 
  ==> $integral_(t_0)^(t_1) #d t (vel(y)^2) = - integral_(t_0)^(t_1) #d t ‚ü® y mid(|) (#d^2)/(#d t^2) mid(|) y ‚ü©$

  Now
  $
    integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(#i/‚Ñè S[y(t)]) 
    = integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(- (#i m)/(2 ‚Ñè) integral_(t_0)^(t_1) #d t ‚ü® y mid(|) (#d^2)/(#d t^2) mid(|) y ‚ü©)
  $
  As a generalization of Gaussian integral

  - Quadratic form $‚ü® y mid(|) (#d^2)/(#d t^2) mid(|) y ‚ü©$ 
  - $y(t_0) = y(t_1) = 0$. To simplify notation, use $t_0 = 0, t_1 = T$
  ==> Eigenvalues $Œª_n = (n œÄ/T)^2$. $L^2$ orthogonal eigenfunctions $sin(n œÄ/T t)$. Expansion of $L^2$ orthogonal eigenfunctions or Fourier expansion $y(t) = sum_(n = 1 .. ‚àû) y_n sin(n œÄ/T t)$

  Diagonalize with $L^2$ orthogonal basis. Now
  $
    integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(- (#i m)/(2 ‚Ñè) integral_(t_0)^(t_1) #d t ‚ü® y mid(|) (#d^2)/(#d t^2) mid(|) y ‚ü©)
    = product_(n = 1 .. ‚àû) integral_(‚àû)^(‚àû) e^(- a_n y_n^2)  #d y_n
  $
  Using the normalization from #link(<why-pi-in-Gaussian-integral>)[], part of the infinite product becomes $product_(n = 1 .. ‚àû) 1 = 1$. The final result is
  $
    integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(- (#i m)/(2 ‚Ñè) integral_(t_0)^(t_1) #d t ‚ü® y mid(|) (#d^2)/(#d t^2) mid(|) y ‚ü©) 
    = (frac(m,2 œÄ #i ‚Ñè T))^(1/2)
  $
  The total result is
  $
    K(t_0,x_0,t_1,x_1) = (frac(m,2 œÄ #i ‚Ñè (t_1 - t_1)))^(1/2) exp((#i m)/(2 ‚Ñè) frac((x_1 - x_0)^2,t_1 - t_0))
  $

  For the harmonic oscillator, similar to

  Using integration by parts
  $
    K(t_0,x_0,t_1,x_1) = exp(#i/‚Ñè S[x_"cl" (t)]) integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(#i/‚Ñè S[y(t)])
  $
  - Quadratic form $‚ü® y mid(|) (#d^2)/(#d t^2) + œâ^2 mid(|) y ‚ü©$ 
  - $y(t_0) = y(t_1) = 0$. For simpler notation, use $t_0 = 0, t_1 = T$
  ==> Eigenvalues $Œª_n = (n œÄ/T)^2 - œâ^2 = (n œÄ/T)^2 (1 - ((œâ T)/(œÄ n))^2)$. $L^2$ orthogonal eigenfunctions $sin(n œÄ/T t)$. $L^2$ orthogonal eigenfunction expansion or Fourier expansion $y(t) = sum_(n = 1 .. ‚àû) y_n sin(n œÄ/T t)$

  Diagonalize using an orthogonal basis and a generalization of the Gaussian integral. The difference from the free field is the emergence of a new infinite product $product_(n = 1 .. ‚àû) (1 - ((œâ T)/(œÄ n))^2) = (sin œâ T)/(œâ T)$ (cf. #link(<Euler-reflection-formula>)[])

  The result is
  $
    integral_(y(t_0) = 0)^(y(t_1) = 0) #d y(t) exp(#i/‚Ñè S[y(t)]) 
    = (frac(m œâ, 2 œÄ ‚Ñè #i sin œâ T))^(1/2) 
  $
  The total result is
  $
    K(t_0,x_0,t_1,x_1) \
    = (frac(m œâ, 2 œÄ ‚Ñè #i sin œâ (t_1 - t_0)))^(1/2) exp((#i m œâ)/(2 ‚Ñè) ‚ãÖ 
      frac(
        (|x_1|^2 + |x_0|^2) cos œâ (t_1 - t_0) - 2 x_1 x_0, 
        sin œâ (t_1 - t_0)
      ) )
  $
]
#tag("eigen-decomposition") 
#indent[
  Characteristic equation given by $e^(-E/h t #i) œà(x)$
  $
    #H œà = E œà
  $
  Decomposition of $#H, e^(- #i 1/‚Ñè #H t), K(t_0,t,x_0,x)$ given by characteristic orthonormal basis $ket(n)$
  $
    #H &= sum_(n) E_n ket(n) bra(n) \
    e^(- #i 1/‚Ñè #H t) &= sum_(n) e^(- #i 1/‚Ñè E_n t) ket(n) bra(n) \
    K &= sum_(n) e^(- #i 1/‚Ñè E_n t) ‚ü® x ket(n) bra(n) x_0 ‚ü© 
  $
  According to #link("https://en.wikipedia.org/wiki/Path_integral_formulation#Simple_harmonic_oscillator")[wiki:Path_integral_formulation], $K = ((m œâ)/(œÄ ‚Ñè))^(1/2) e^(- #i 1/2 œâ T) R(e^(- #i œâ T))$ then let $R$ perform Taylor expansion, where $e^(- #i 1/2 œâ T) e^(- #i n œâ T) = e^(- #i (1/2 + n) œâ T)$ corresponds to energy level $E_n = (1/2 + n) ‚Ñè œâ$
]
Regarding field quantization

One perspective is path integral quantization of fields.

#tag("field-path-integral-quantization") *Question* Since the harmonic oscillator can be path-integrated by eigenvalue diagonalization & generalized Gaussian integral, why don't KG eq (or Dirac eq) similar to the harmonic oscillator eq also perform #link(<linear-superposition-of-KG-eq>)[eigenvalue diagonalization] & generalized Gaussian integral path integral? 

Another (?) perspective is field operator quantization of fields.

recall #link(<Klein--Gordon-equation>)[] Consider the plane wave solution
$
  (‚àÇ_t^2 - ‚àÇ_x^2 + m^2) e^((p_0(p) t - p x) (¬± #i)) &= 0 \
  (‚àÇ_t^2 + p^2 + m^2) e^((p_0(p) t - p x) (¬± #i)) &= 0
$
If we ignore plane waves, even if we might lose accuracy, we get an ODE
$
  (‚àÇ_t^2 + p^2 + m^2) œï = 0
$
This is the $‚ÑÇ$-valued point particle harmonic oscillator equation, with frequency $œâ = E = p_0 = (p^2 + m^2)^(1/2)$

Then the point particle harmonic oscillator can be quantized

recall #link(<linear-superposition-of-KG-eq>)[] $L^2$ superposition of KG plane waves on the hyperboloid $‚Ñçùï™^3 = {p^2 = m^2}$
$ 
  œï(t, x) = integral_(‚Ñçùï™^3) #d p  
  (
    a(p,#i) e^(E t #i) e^(- p x #i) 
    + a(p,-#i) e^(- E t #i) e^(p x #i)
  )
$
*Question* Homomorphize the quantum harmonic oscillator of point particles to the quantum harmonic oscillator of the KG field, with $L^2 (‚Ñçùï™^3,‚ÑÇ)$ coefficient constraint (Sobolev), the coefficient constraint of multiple raising and lowering corresponds to $L^2$ symmetric tensors, the entire space is $‚®Å_(n in ‚Ñï) ‚®Ä^n L^2 (‚Ñçùï™^3, L^2(‚ÑÇ,‚ÑÇ))$ (where $L^2(‚ÑÇ,‚ÑÇ)$ is the space of $‚ÑÇ$ harmonic oscillator quantization)

*Question* Is this tensor based on the $L^2 (‚Ñçùï™^3,‚ÑÇ)$ module? 

Vacuum $0$ is something lower than zero order

The energy operator of the KG field quantum harmonic oscillator can also be expressed in the form of KG field operator + energy of the KG field, even if this is not calculating the energy of the KG field (field operator after differential plane wave expansion) 
$
  integral_(‚Ñçùï™^3 \ ùïä(Im(‚ÑÇ))) #d p #d #i 1/2 (#a (p,#i)^‚Ä† #a (p,#i) + #a (p,#i) #a (p,#i)^‚Ä†) 

  = integral_(‚Ñù^3) #d x 1/2 (‚àÇ_t œï^‚Ä† ‚àÇ_t œï + ‚àÇ_x œï^‚Ä† ‚àÇ_x œï + m^2 œï^‚Ä† œï)
$
For the Dirac field, it seems that there is no need to do what the KG field does, because "once" quantization already exists, but it is finite-dimensional, a representation comes from the two eigenvalues of $su(2), ‚ÑÇ^2$ #link(<Pauli-matrix>)[] (@ref-18, p.305--308)

- $#H = 1/2 œÉ_1 = 1/2 mat(1 ;, -1) \ 
  #i #H in su(2)$
  
- $#H vec(1,0) &= 1/2 vec(1,0) \
  #H vec(0,1) &= - 1/2 vec(0,1)$
  
- $#a _(¬±) &= 1/2 (œÉ_2 ¬± 1/#i œÉ_3) \ 
  #a _+ &= mat(,1;0) \ 
  #a _- &= mat(,0;1)$

- $(#a _(¬±))^‚Ä† = a_(‚àì)$

- $(#a _(¬±))^2 = 0$

- $#a _+ vec(0,1) = vec(1,0) \
  #a _- vec(1,0) = vec(0,1)$

- $1/2 {#a _+,#a _-} = ùüô$

- $1/2 [#a _+,#a _-] = #H$

- $[#H, #a _(¬±)] = ¬± #a _(¬±)$

After adding parity, it is $‚ÑÇ^2 ‚äï ‚ÑÇ^(2 ‚óä)$

#let p = spin($p$)

recall #link(<linear-superposition-of-Dirac-eq>)[] $L^2$ superposition of Dirac plane waves on $‚Ñçùï™^3$
$
  limits(integral)_(‚Ñçùï™^3) #d p
    (vec(#p^(‚óä 1/2) Œæ, #p^(1/2) Œæ)(p) e^(- p x #i) + vec(#p^(‚óä 1/2) Œ∑, - #p^(1/2) Œ∑)(p) e^(p x #i))
$
*Question* Homomorphically map it to the quantum field of the Dirac field, plus $L^2 (‚Ñçùï™^3,‚ÑÇ^2 ‚äï ‚ÑÇ^(2 ‚óä))$ coefficient restriction (Sobolev), the coefficient restriction of multiple raising and lowering corresponds to $L^2$ alternating tensor, the entire space is $‚®Å_(n in ‚Ñï) ‚ãÄ^n L^2 (‚Ñçùï™^3,‚ÑÇ^2 ‚äï ‚ÑÇ^(2 ‚óä))$

*Question* Is this tensor based on the $L^2 (‚Ñçùï™^3,‚ÑÇ)$ module? 

Vacuum $0$ is something lower than zero order

The energy operator of the Dirac field quantum field can also be expressed in the form of Dirac field operator + energy of the Dirac field, even if this is not calculating the energy of the Dirac field
$
  integral_(‚Ñçùï™^3 \ ùïä(Im(‚ÑÇ))) #d p #d #i 1/2 (#a (p,#i)^‚Ä† #a (p,#i) - #a (p,#i) #a (p,#i)^‚Ä†) 

  &= integral_(‚Ñù^3) #d x vec(œï,œà)^‚Ä† #i ‚àÇ_0 vec(œï,œà) \

  &= integral_(‚Ñù^3) #d x vec(œï,œà)^‚Ä† mat(
      #i #spin-d _x , m ùüô ;
      m ùüô , - #i #spin-d _x
    ) vec(œï,œà)
$